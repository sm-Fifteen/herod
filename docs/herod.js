!function(){"use strict";var e="undefined"==typeof window?global:window;if("function"!=typeof e.require){var t={},r={},n={},a={}.hasOwnProperty,u=/^\.\.?(\/|$)/,o=function(e,t){for(var r,n=[],a=(u.test(t)?e+"/"+t:t).split("/"),o=0,i=a.length;o<i;o++)r=a[o],".."===r?n.pop():"."!==r&&""!==r&&n.push(r);return n.join("/")},i=function(e){return e.split("/").slice(0,-1).join("/")},c=function(t){return function(r){var n=o(i(t),r);return e.require(n,t)}},s=function(e,t){var n=null;n=b&&b.createHot(e);var a={id:e,exports:{},hot:n};return r[e]=a,t(a.exports,c(e),a),a.exports},l=function(e){return n[e]?l(n[e]):e},f=function(e,t){return l(o(i(e),t))},d=function(e,n){null==n&&(n="/");var u=l(e);if(a.call(r,u))return r[u].exports;if(a.call(t,u))return s(u,t[u]);throw new Error("Cannot find module '"+e+"' from '"+n+"'")};d.alias=function(e,t){n[t]=e};var p=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/,v=function(e){if(p.test(e)){var t=e.replace(p,"");a.call(n,t)&&n[t].replace(p,"")!==t+"/index"||(n[t]=e)}if(h.test(e)){var r=e.replace(h,"");a.call(n,r)||(n[r]=e)}};d.register=d.define=function(e,n){if("object"==typeof e)for(var u in e)a.call(e,u)&&d.register(u,e[u]);else t[e]=n,delete r[e],v(e)},d.list=function(){var e=[];for(var r in t)a.call(t,r)&&e.push(r);return e};var b=e._hmr&&new e._hmr(f,d,t,r);d._cache=r,d.hmr=b&&b.wrap,d.brunch=!0,e.require=d}}(),function(){var e;window;require.register("app.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var a=t("lodash"),u=n(a),o=t("angular"),i=n(o);t("angular-ui-bootstrap");var c=t("paper"),s=n(c),l=t("ressources"),f=n(l),d=t("ecu"),p=n(d),h=t("geometry"),v=n(h),b=t("table-attente"),g=n(b),w=i["default"].module("herod",["ui.bootstrap"]);window.DEBUG=0,window.setup=!0,w.directive("ecuViewport",["$timeout",function(e){return{restrict:"A",scope:!0,link:function(t,r){function n(e,t){var r=[];return e.partition.cuts.forEach(function(n){var a=v["default"].slice(s["default"],t,n,e.table.points);r.push(a[1]),t=a[0]}),r.push(t),r.forEach(function(t,r){var n=e.children[r];n.shape=t,t.fillColor=n.couleur}),r}function a(e){if(window.setup&&(s["default"].setup(e),delete window.setup),t.ecu){var r=s["default"].PathItem.create(t.ecu.forme);r.fitBounds(s["default"].view.bounds),t.ecu.champ.table||(t.ecu.champ.table=g["default"].generateTable(s["default"],r)),t.ecu.layoutShapes=n(t.ecu.champ,r.clone()),console.log(t.ecu.layoutShapes)}s["default"].view.draw()}e(a(r[0]),0),s["default"].view.onMouseDown=function(e){var r=s["default"].project.hitTest(e.point);r&&u["default"].includes(t.ecu.layoutShapes,r.item)&&t.$apply(function(){t.ecu.selectedShape=r.item})},t.$watch("ecu.champ.partition",function(e,n){e!==n&&(s["default"].project.clear(),a(r[0]),t.ecu.selectedPart&&(t.ecu.selectedShape=t.ecu.selectedPart.shape,t.ecu.selectedShape.selected=!0))})}}}]),w.controller("EcuCtrl",function(e){e.Couleurs=f["default"].couleurs,e.Partitions=f["default"].partitions,e.ecu=new p["default"],e.$watch("ecu.selectedShape",function(t,r){t&&(r&&(r.selected=!1),t.selected=!0,e.ecu.selectedPart=u["default"].find(e.ecu.champ.children,function(e){return e.shape===t}))}),e.$watch("ecu.selectedPart.couleur",function(t){u["default"].get(e.ecu.selectedPart,"shape")&&(e.ecu.selectedPart.shape.fillColor=t)})})}),require.register("ecu.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=t("ressources"),o=n(u),i=function c(){a(this,c),this.forme=o["default"].formes.ecuFrancais,this.champ=c.testPartitionGroup,this.selectedShape=void 0,this.selectedPart=void 0};i.testPartitionGroup={partition:o["default"].partitions.ecartele,children:[{couleur:o["default"].couleurs.azur},{couleur:o["default"].couleurs.sable},{couleur:o["default"].couleurs.sable},{couleur:o["default"].couleurs.azur}]},e["default"]=i}),require.register("geometry.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("lodash"),i=n(o),c=function(){function e(){a(this,e)}return u(e,null,[{key:"extrapolateLine",value:function(e,t,r,n){var a=n.clone().rotate(180,r),u=new e.Path.Line(n,a),o=0,i=0;u.bounds.width>=1&&(o=(t.bounds.width+2*Math.abs(t.bounds.center.x-r.x))/u.bounds.width),u.bounds.height>=1&&(i=(t.bounds.height+2*Math.abs(t.bounds.center.y-r.y))/u.bounds.height);var c=Math.max(o,i);return u.scale(c,r)}},{key:"edgeScan",value:function(e,t,r,n){var a=this.extrapolateLine(e,t,r,n);return i["default"].map(t.getIntersections(a),"point").sort(function(e,t){return n.getDistance(t)-n.getDistance(e)})}},{key:"divideSurface2D",value:function(e,t,r){var n=this.divideSurface(e,t,r),a=e.view.bounds.topLeft;t.scale(1,-1,a).rotate(90,a);var u=this.divideSurface(e,t,r);return t.scale(1,-1,a).rotate(90,a),{x:n,y:u}}},{key:"divideSurface",value:function(e,t,r){for(var n=r-1,a=Math.abs(t.area/r),u=a/200,o=[t.bounds.left],i=1;i<=n;i++){for(var c=o[i-1],s=t.bounds.width/(r-i+1),l=new e.Size(s,t.bounds.height);;){var f=new e.Path.Rectangle(new e.Point(c,t.bounds.y),l),d=new e.Path(f.intersect(t).pathData).area,p=a-d;if(Math.abs(p)<u){o[i]=f.bounds.right;break}var h=t.getIntersections(new e.Path.Line({from:[f.bounds.right,t.bounds.top],to:[f.bounds.right,t.bounds.bottom]})),v=h[0].point.getDistance(h.reverse()[0].point);l.width+=p/v/2}o[n+1]=t.bounds.right}return o}},{key:"slice",value:function(e,t,r,n){var a=new e.Path;r.forEach(function(e){return a.add(n[e])});var u=[t.getNearestLocation(n[r[0]]),t.getNearestLocation(n[r.reverse()[0]])],o=u[1].curve,i=o.splitAt(u[1]);i===t&&(o=u[0].curve,i=o.splitAt(u[0]));var c=[t,i];return t.length<i.length&&(c=[i,t]),t.join(a.clone(),5),t.closePath(),i.join(a.clone(),5),i.closePath(),c}}]),e}();e["default"]=c}),require.register("ressources.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={formes:{ecuFrancais:"M0,0 L0,50 Q0,80 50,110 Q100,80 100,50 L100,0 z"},couleurs:{azur:"#2b5df2",sable:"#000000",sinople:"#5ab532",pourpre:"#d576ad",or:"#fcef3c",argent:"#ffffff"},divisionModel:{axisAligned:"stripes",aroundCenter:"slices"},partitions:{parti:{cuts:[["pointChef","pointPointe"]],nameFr:["Parti"]},coupe:{cuts:[["flancDextre","flancSenestre"]],nameFr:["Coupé"]},tranche:{cuts:[["chefDextre","pointeSenestre"]],nameFr:["Tranché"]},taille:{cuts:[["chefSenestre","pointeDextre"]],nameFr:["Taillé"]},ecartele:{cuts:[["flancDextre","abyme","pointChef"],["pointChef","abyme","flancSenestre"],["flancDextre","abyme","pointPointe"]]},ecarteleSautoir:{cuts:[["chefDextre","abyme","chefSenestre"],["chefDextre","abyme","pointeDextre"],["chefSenestre","abyme","pointeSenestre"]]},tiercePairle:{cuts:[["chefDextre","abyme","chefSenestre"],["chefDextre","abyme","pointPointe"],["chefSenestre","abyme","pointPointe"]]},tiercePairleInv:{cuts:[["pointeDextre","abyme","pointChef"],["pointeSenestre","abyme","pointChef"],["pointeDextre","abyme","pointeSenestre"]]}}};e["default"]=n}),require.register("table-attente.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("geometry"),i=n(o),c=function(){function e(t,r){a(this,e),this.points=t,this.regions=r}return u(e,null,[{key:"generateTable",value:function(t,r){return new e(e.generatePoints(t,r),e.generateRegions(t,r))}},{key:"generatePoints",value:function(e,t){var r=i["default"].divideSurface2D(e,t,2),n=new e.Point(r.x[1],r.y[1]),a=i["default"].edgeScan(e,t,n,new e.Point(r.x[1],r.y[2])),u=i["default"].edgeScan(e,t,n,new e.Point(r.x[2],r.y[1])),o=i["default"].edgeScan(e,t,new e.Point(r.x[0],r.y[0]),n),c=i["default"].edgeScan(e,t,new e.Point(r.x[2],r.y[0]),n);return{pointChef:a[0],pointPointe:a.reverse()[0],flancDextre:u[0],flancSenestre:u.reverse()[0],chefDextre:o[0],pointeSenestre:o.reverse()[0],chefSenestre:c[0],pointeDextre:c.reverse()[0],abyme:n}}},{key:"generateRegions",value:function(e,t){for(var r=3,n=i["default"].divideSurface2D(e,t,r),a=[],u=0;u<r;u++)for(var o=n.y[u],c=n.y[u+1],s=0;s<r;s++){var l=n.x[s],f=n.x[s+1];a.push(new e.Path.Rectangle({from:[l,o],to:[f,c]}))}return a}}]),e}();e["default"]=c}),require.alias("buffer/index.js","buffer"),require.alias("process/browser.js","process"),e=require("process"),require.register("___globals___",function(e,t,r){})}(),require("___globals___"),require("app");